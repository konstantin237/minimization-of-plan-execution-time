"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){l=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return("string"===e?String:Number)(t);var n=r.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}var AssignmentModel=function(){function b(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3;_classCallCheck(this,b),this.size=t,this.C=Array.from({length:t},function(){return Array(t).fill(0)}),this.T=Array.from({length:t},function(){return Array(t).fill(0)}),this.S=0,this.T_type="min",this.T_limit=""}return _createClass(b,[{key:"setMatrixC",value:function(t){this.C=t}},{key:"setMatrixT",value:function(t){this.T=t}},{key:"setS",value:function(t){this.S=t}},{key:"setTType",value:function(t){this.T_type=t}},{key:"setTLimit",value:function(t){this.T_limit=t}},{key:"solve",value:function(){var t,e=this,r=this.size,n=Array.from({length:r},function(t,e){return e}),a=[],i=_createForOfIteratorHelper(b.permutations(n));try{for(i.s();!(t=i.n()).done;){for(var o=t.value,l=0,u=[],s=[],c=0;c<r;c++){var f=this.C[c][o[c]],m=this.T[c][o[c]];l+=f,u.push(m),s.push({worker:c+1,job:o[c]+1,c:f,t:m})}var y="min"===this.T_type?Math.max.apply(Math,u):Math.min.apply(Math,u),h=!0;this.S&&l>this.S&&(h=!1),a.push({perm:o,sumC:l,T_value:y,table:s,valid:h})}}catch(t){i.e(t)}finally{i.f()}var d,v=a.filter(function(t){return t.valid});if(""!==this.T_limit&&(v="min"===this.T_type?v.filter(function(t){return t.T_value<=e.T_limit}):v.filter(function(t){return t.T_value>=e.T_limit})),0===v.length)return{answer:"Нет допустимых решений",solutions:a};if("min"===this.T_type){var p=Math.min.apply(Math,_toConsumableArray(v.map(function(t){return t.T_value})));d=v.find(function(t){return t.T_value===p})}else{var T=Math.max.apply(Math,_toConsumableArray(v.map(function(t){return t.T_value})));d=v.find(function(t){return t.T_value===T})}return{answer:d,solutions:a}}}],[{key:"permutations",value:function(t){if(1===t.length)return[t];for(var e=[],r=0;r<t.length;r++){var n,a=t.slice(0,r).concat(t.slice(r+1)),i=_createForOfIteratorHelper(b.permutations(a));try{for(i.s();!(n=i.n()).done;){var o=n.value;e.push([t[r]].concat(o))}}catch(t){i.e(t)}finally{i.f()}}return e}}])}(),AssignmentView=function(){return _createClass(function t(){_classCallCheck(this,t),this.matrixCTextarea=document.getElementById("matrix-c-textarea"),this.matrixTTextarea=document.getElementById("matrix-t-textarea")},[{key:"parseMatrixFromTextarea",value:function(t){var e=t.trim().split("\n").filter(function(t){return""!==t.trim()}).map(function(t){return t.trim().split(/\s+/).map(Number)}),r=Math.min.apply(Math,_toConsumableArray(e.map(function(t){return t.length}))),n=e.map(function(t){return t.slice(0,r)});return{matrix:n,size:n.length}}},{key:"getMatrixC",value:function(){return this.matrixCTextarea?this.parseMatrixFromTextarea(this.matrixCTextarea.value):{matrix:[],size:0}}},{key:"getMatrixT",value:function(){return this.matrixTTextarea?this.parseMatrixFromTextarea(this.matrixTTextarea.value):{matrix:[],size:0}}},{key:"getParams",value:function(){return{S:+document.getElementById("salary-fund").value,T_type:document.getElementById("t-type").value,T_limit:""===document.getElementById("t-limit").value?"":+document.getElementById("t-limit").value}}},{key:"renderAnswer",value:function(t){var e=document.getElementById("answer");if("string"!=typeof t){for(var r="<table><thead><tr><th></th><th><b>Решение</b></th></tr></thead><tbody>",n=0;n<t.perm.length;n++)r+="<tr><th>x".concat(n+1,"</th><td>").concat(t.perm[n]+1," (C: ").concat(t.table[n].c,", T: ").concat(t.table[n].t,")</td></tr>");r+="<tr><th>S</th><td>".concat(t.sumC,"</td></tr>"),r+="<tr><th>T</th><td>".concat(t.T_value,"</td></tr>"),r+="</tbody></table>",e.innerHTML=r}else e.textContent=t}},{key:"renderSolutionTable",value:function(t){var e=document.getElementById("solution-table");if(t&&0!==t.length){var r=t[0].perm.length,i="<table><thead><tr><th></th>";t.forEach(function(t,e){i+="<th".concat(t.valid?"":' style="opacity:0.5"',">Решение № ").concat(e+1,"</th>")}),i+="</tr></thead><tbody>";for(var n=function(a){i+="<tr><th>x".concat(a+1,"</th>"),t.forEach(function(t){var e=t.perm[a],r=t.table[a].c,n=t.table[a].t;i+="<td".concat(t.valid?"":' style="opacity:0.5"',">").concat(e+1," (C: ").concat(r,", T: ").concat(n,")</td>")}),i+="</tr>"},a=0;a<r;a++)n(a);i+="<tr><th>S</th>",t.forEach(function(t){i+="<td".concat(t.valid?"":' style="opacity:0.5"',">").concat(t.sumC,"</td>")}),i+="</tr>",i+="<tr><th>T</th>",t.forEach(function(t){i+="<td".concat(t.valid?"":' style="opacity:0.5"',">").concat(t.T_value,"</td>")}),i+="</tr>",i+="</tbody></table>",e.innerHTML=i}else e.innerHTML=""}}])}(),AssignmentController=function(){return _createClass(function t(){_classCallCheck(this,t),this.model=null,this.view=new AssignmentView,this.initEvents()},[{key:"initEvents",value:function(){var t=this;document.getElementById("solve-btn").addEventListener("click",function(){return t.solve()})}},{key:"solve",value:function(){var t=this.view.getMatrixC(),e=t.matrix,r=t.size,n=this.view.getMatrixT(),a=n.matrix,i=n.size;window.assignmentModelInputC=e,window.assignmentModelInputT=a;var o=Math.min(r,i);if(!o||e.length!==o||a.length!==o)return this.view.renderAnswer("Ошибка: некорректный ввод матриц"),void this.view.renderSolutionTable([]);this.model=new AssignmentModel(o),this.model.setMatrixC(e),this.model.setMatrixT(a);var l=this.view.getParams();this.model.setS(l.S),this.model.setTType(l.T_type),this.model.setTLimit(l.T_limit);var u=this.model.solve(),s=u.answer,c=u.solutions;this.view.renderAnswer(s.answer||s),this.view.renderSolutionTable(c)}}])}();window.addEventListener("DOMContentLoaded",function(){new AssignmentController});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpcnN0X3NjcmlwdC5qcyJdLCJuYW1lcyI6WyJBc3NpZ25tZW50TW9kZWwiLCJzaXplIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsIkMiLCJBcnJheSIsImZyb20iLCJmaWxsIiwiVCIsIlMiLCJUX3R5cGUiLCJUX2xpbWl0IiwiX2NyZWF0ZUNsYXNzIiwia2V5IiwidmFsdWUiLCJfc3RlcCIsIl90aGlzIiwibiIsIl8iLCJpIiwic29sdXRpb25zIiwicGVybXV0YXRpb25zIiwiam9icyIsInBlcm0iLCJzdW1DIiwidGltZXMiLCJ0YWJsZSIsImMiLCJ0Iiwic2V0TWF0cml4VCIsInB1c2giLCJ3b3JrZXIiLCJqb2IiLCJUX3ZhbHVlIiwic2V0UyIsIk1hdGgiLCJtYXgiLCJhcHBseSIsIm1pbiIsInZhbGlkIiwiZXJyIiwiX2l0ZXJhdG9yIiwiZSIsImYiLCJiZXN0IiwiZmlsdGVyZWQiLCJmaWx0ZXIiLCJzIiwic2V0VExpbWl0IiwiYW5zd2VyIiwibWluVCIsIl90b0NvbnN1bWFibGVBcnJheSIsIm1hcCIsInNvbHZlIiwiZmluZCIsIm1heFQiLCJyZXN1bHQiLCJhcnIiLCJfc3RlcDIiLCJyZXN0IiwiX2l0ZXJhdG9yMiIsImRvbmUiLCJjb25jYXQiLCJBc3NpZ25tZW50VmlldyIsIm1hdHJpeENUZXh0YXJlYSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJtYXRyaXhUVGV4dGFyZWEiLCJtYXRyaXgiLCJ0ZXh0YXJlYVZhbHVlIiwic3BsaXQiLCJsaW5lIiwidHJpbSIsIk51bWJlciIsIm1pbkxlbiIsInJvdyIsInNxdWFyZU1hdHJpeCIsInNsaWNlIiwicGFyc2VNYXRyaXhGcm9tVGV4dGFyZWEiLCJhbnN3ZXJFbCIsImh0bWwiLCJpbm5lckhUTUwiLCJ0ZXh0Q29udGVudCIsInRhYmxlRGl2IiwiaWR4Iiwic29sIiwiX2xvb3AiLCJmb3JFYWNoIiwiam9iSWR4IiwiQXNzaWdubWVudENvbnRyb2xsZXIiLCJtb2RlbCIsInZpZXciLCJpbml0RXZlbnRzIiwiX3RoaXMyIiwiX3RoaXMkdmlldyRnZXRNYXRyaXhDIiwiZ2V0TWF0cml4QyIsInNpemVDIiwiX3RoaXMkdmlldyRnZXRNYXRyaXhUIiwiZ2V0TWF0cml4VCIsInNpemVUIiwid2luZG93IiwiYXNzaWdubWVudE1vZGVsSW5wdXRUIiwicmVuZGVyQW5zd2VyIiwicmVuZGVyU29sdXRpb25UYWJsZSIsInBhcmFtcyIsInNldFRUeXBlIiwiX3RoaXMkbW9kZWwkc29sdmUiLCJhZGRFdmVudExpc3RlbmVyIl0sIm1hcHBpbmdzIjoiMnJGQUFBLElBQ01BLGdCQUFlLFdBQ25CLFNBQUFBLElBQXNCLElBQVZDLEVBQUksRUFBQUMsVUFBQUMsYUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQUcsRUFBQ0csZ0JBQUFDLEtBQUFOLEdBQ2xCTSxLQUFLTCxLQUFPQSxFQUNaSyxLQUFLQyxFQUFJQyxNQUFNQyxLQUFLLENBQUVOLE9BQVFGLEdBQVEsV0FBQSxPQUFNTyxNQUFNUCxHQUFNUyxLQUFLLEtBQzdESixLQUFLSyxFQUFJSCxNQUFNQyxLQUFLLENBQUVOLE9BQVFGLEdBQVEsV0FBQSxPQUFNTyxNQUFNUCxHQUFNUyxLQUFLLEtBQzdESixLQUFLTSxFQUFJLEVBQ1ROLEtBQUtPLE9BQVMsTUFDZFAsS0FBS1EsUUFBVSxHQUNoQixPQUFBQyxhQUFBZixFQUFBLENBQUEsQ0FBQWdCLElBQUEsYUFBQUMsTUFFRCxTQUFXVixHQUFLRCxLQUFLQyxFQUFJQSxJQUFJLENBQUFTLElBQUEsYUFBQUMsTUFDN0IsU0FBV04sR0FBS0wsS0FBS0ssRUFBSUEsSUFBSSxDQUFBSyxJQUFBLE9BQUFDLE1BQzdCLFNBQUtMLEdBQUtOLEtBQUtNLEVBQUlBLElBQUksQ0FBQUksSUFBQSxXQUFBQyxNQUN2QixTQUFTSixHQUFVUCxLQUFLTyxPQUFTQSxJQUFTLENBQUFHLElBQUEsWUFBQUMsTUFkNUMsU0FBQUgsR0FBQVIsS0FBQVEsUUFBQUEs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QUEsV0FBQSxPQUFBc0UsRUFBQXhDLFlBOEl2QyxDQUFBeEMsSUFBQSxRQUFBQyxNQUNELFdBQ0UsSUFBQWdGLEVBL0lHM0YsS0FBQXdGLEtBQUFJLGFBQUEzRixFQUFBc0MsRUFBQWtCLE9BQUFvQyxFQUFBRixFQUFBdEQsS0FnSkh5RCxFQWhKRzlGLEtBQUF3RixLQUFBTyxhQUFBMUYsRUFBQXlGLEVBQUE3QixPQUFBK0IsRUFBQUYsRUFBQW5HLEtBaUpIc0csT0FqSkd4QyxzQkFBQXhELEVBa0pIZ0csT0FsSkdDLHNCQUFBN0YsRUFtSkgsSUFsSkFTLEVBQUFrQixLQUFBRyxJQUFBMEQsRUFBQUcsR0FtSkEsSUFsSkFsRixHQUFPdUMsRUFBQUEsU0FBTXZDLEdBQUFULEVBQUFSLFNBQUFpQixFQWdEakIsT0EvQ0VkLEtBQUF3RixLQUFBVyxhQUFBLHlDQUFDbkcsS0FBQXdGLEtBQUFZLG9CQUFBLElBaUREcEcsS0FBQXVGLE1BQUEzQixJQUFBQSxnQkFBYzlDLEdBQUFmLEtBQUFBLE1BQUFBLFdBQUE2RCxHQUNaNUQsS0FBSzZELE1BQUFBLFdBQWV4RCxHQUNwQixJQUFLMkQsRUFBQUEsS0FBZXdCLEtBQUcxQixZQUN2QjlELEtBQUF1RixNQUFBeEQsS0FBQXNFLEVBQUEvRixHQUNGTixLQUFBdUYsTUFBQWUsU0FBQUQsRUFBQTlGLFFBdUdFUCxLQUFLdUYsTUFBTTFDLFVBQVV3RCxFQUFPN0YsU0FyRzlCLElBQUErRixFQUFBdkcsS0FBQXVGLE1BQUFyQyxRQUFBSixFQUFBeUQsRUFBQXpELE9BQUE3QixFQUFBc0YsRUFBQXRGLFVBQUFqQixLQUFBUyxLQUFBQSxhQUFBbUQsRUFBQUEsUUFBQWQsR0FBQXBDLEtBQUE4RSxLQUFBWSxvQkFBQW5GLE9BOURzQnFDLEdBMkt4QjJDLE9BMUdJTyxpQkFBb0IsbUJBQVMsV0EyRy9CLElBQUlsQiIsImZpbGUiOiJmaXJzdF9zY3JpcHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBNb2RlbFxuY2xhc3MgQXNzaWdubWVudE1vZGVsIHtcbiAgY29uc3RydWN0b3Ioc2l6ZSA9IDMpIHtcbiAgICB0aGlzLnNpemUgPSBzaXplO1xuICAgIHRoaXMuQyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IHNpemUgfSwgKCkgPT4gQXJyYXkoc2l6ZSkuZmlsbCgwKSk7XG4gICAgdGhpcy5UID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogc2l6ZSB9LCAoKSA9PiBBcnJheShzaXplKS5maWxsKDApKTtcbiAgICB0aGlzLlMgPSAwO1xuICAgIHRoaXMuVF90eXBlID0gJ21pbic7XG4gICAgdGhpcy5UX2xpbWl0ID0gJyc7XG4gIH1cblxuICBzZXRNYXRyaXhDKEMpIHsgdGhpcy5DID0gQzsgfVxuICBzZXRNYXRyaXhUKFQpIHsgdGhpcy5UID0gVDsgfVxuICBzZXRTKFMpIHsgdGhpcy5TID0gUzsgfVxuICBzZXRUVHlwZShUX3R5cGUpIHsgdGhpcy5UX3R5cGUgPSBUX3R5cGU7IH1cbiAgc2V0VExpbWl0KFRfbGltaXQpIHsgdGhpcy5UX2xpbWl0ID0gVF9saW1pdDsgfVxuXG4gIC8vINCT0LXQvdC10YDQsNGG0LjRjyDQstGB0LXRhSDQv9C10YDQtdGB0YLQsNC90L7QstC+0Log0YDQsNCx0L7RgiDQtNC70Y8gbiDRgNCw0LHQvtGC0L3QuNC60L7QslxuICBzdGF0aWMgcGVybXV0YXRpb25zKGFycikge1xuICAgIGlmIChhcnIubGVuZ3RoID09PSAxKSByZXR1cm4gW2Fycl07XG4gICAgbGV0IHJlc3VsdCA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgcmVzdCA9IGFyci5zbGljZSgwLCBpKS5jb25jYXQoYXJyLnNsaWNlKGkgKyAxKSk7XG4gICAgICBmb3IgKGxldCBwZXJtIG9mIEFzc2lnbm1lbnRNb2RlbC5wZXJtdXRhdGlvbnMocmVzdCkpIHtcbiAgICAgICAgcmVzdWx0LnB1c2goW2FycltpXV0uY29uY2F0KHBlcm0pKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8vINCg0LXRiNC10L3QuNC1INC30LDQtNCw0YfQuCDQviDQvdCw0LfQvdCw0YfQtdC90LjRj9GFINC/0LXRgNC10LHQvtGA0L7QvFxuICBzb2x2ZSgpIHtcbiAgICBjb25zdCBuID0gdGhpcy5zaXplO1xuICAgIGNvbnN0IGpvYnMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBuIH0sIChfLCBpKSA9PiBpKTtcbiAgICBjb25zdCBwZXJtcyA9IEFzc2lnbm1lbnRNb2RlbC5wZXJtdXRhdGlvbnMoam9icyk7XG4gICAgbGV0IHNvbHV0aW9ucyA9IFtdO1xuICAgIGZvciAobGV0IHBlcm0gb2YgcGVybXMpIHtcbiAgICAgIGxldCBzdW1DID0gMDtcbiAgICAgIGxldCB0aW1lcyA9IFtdO1xuICAgICAgbGV0IHRhYmxlID0gW107XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykge1xuICAgICAgICBsZXQgYyA9IHRoaXMuQ1tpXVtwZXJtW2ldXTtcbiAgICAgICAgbGV0IHQgPSB0aGlzLlRbaV1bcGVybVtpXV07XG4gICAgICAgIHN1bUMgKz0gYztcbiAgICAgICAgdGltZXMucHVzaCh0KTtcbiAgICAgICAgdGFibGUucHVzaCh7IHdvcmtlcjogaSArIDEsIGpvYjogcGVybVtpXSArIDEsIGMsIHQgfSk7XG4gICAgICB9XG4gICAgICBsZXQgVF92YWx1ZSA9IHRoaXMuVF90eXBlID09PSAnbWluJyA/IE1hdGgubWF4KC4uLnRpbWVzKSA6IE1hdGgubWluKC4uLnRpbWVzKTtcbiAgICAgIGxldCB2YWxpZCA9IHRydWU7XG4gICAgICBpZiAodGhpcy5TICYmIHN1bUMgPiB0aGlzLlMpIHZhbGlkID0gZmFsc2U7XG4gICAgICAvLyDQndC1INGE0LjQu9GM0YLRgNGD0LXQvCDQv9C+IFRfbGltaXQg0LfQtNC10YHRjCwg0YTQuNC70YzRgtGA0LDRhtC40Y8g0LHRg9C00LXRgiDQvdC40LbQtVxuICAgICAgc29sdXRpb25zLnB1c2goeyBwZXJtLCBzdW1DLCBUX3ZhbHVlLCB0YWJsZSwgdmFsaWQgfSk7XG4gICAgfVxuICAgIC8vINCd0L7QstGL0Lkg0LDQu9Cz0L7RgNC40YLQvCDQstGL0LHQvtGA0LAg0YDQtdGI0LXQvdC40Y9cbiAgICBsZXQgZmlsdGVyZWQgPSBzb2x1dGlvbnMuZmlsdGVyKHMgPT4gcy52YWxpZCk7XG4gICAgaWYgKHRoaXMuVF9saW1pdCAhPT0gJycpIHtcbiAgICAgIGlmICh0aGlzLlRfdHlwZSA9PT0gJ21pbicpIHtcbiAgICAgICAgZmlsdGVyZWQgPSBmaWx0ZXJlZC5maWx0ZXIocyA9PiBzLlRfdmFsdWUgPD0gdGhpcy5UX2xpbWl0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZpbHRlcmVkID0gZmlsdGVyZWQuZmlsdGVyKHMgPT4gcy5UX3ZhbHVlID49IHRoaXMuVF9saW1pdCk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChmaWx0ZXJlZC5sZW5ndGggPT09IDApIHJldHVybiB7IGFuc3dlcjogJ9Cd0LXRgiDQtNC+0L/Rg9GB0YLQuNC80YvRhSDRgNC10YjQtdC90LjQuScsIHNvbHV0aW9ucyB9O1xuICAgIGxldCBiZXN0O1xuICAgIGlmICh0aGlzLlRfdHlwZSA9PT0gJ21pbicpIHtcbiAgICAgIGxldCBtaW5UID0gTWF0aC5taW4oLi4uZmlsdGVyZWQubWFwKHMgPT4gcy5UX3ZhbHVlKSk7XG4gICAgICBiZXN0ID0gZmlsdGVyZWQuZmluZChzID0+IHMuVF92YWx1ZSA9PT0gbWluVCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBtYXhUID0gTWF0aC5tYXgoLi4uZmlsdGVyZWQubWFwKHMgPT4gcy5UX3ZhbHVlKSk7XG4gICAgICBiZXN0ID0gZmlsdGVyZWQuZmluZChzID0+IHMuVF92YWx1ZSA9PT0gbWF4VCk7XG4gICAgfVxuICAgIHJldHVybiB7IGFuc3dlcjogYmVzdCwgc29sdXRpb25zIH07XG4gIH1cbn1cblxuLy8gVmlld1xuY2xhc3MgQXNzaWdubWVudFZpZXcge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLm1hdHJpeENUZXh0YXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXRyaXgtYy10ZXh0YXJlYScpO1xuICAgIHRoaXMubWF0cml4VFRleHRhcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hdHJpeC10LXRleHRhcmVhJyk7XG4gICAgLy8g0KHQtNC10LvQsNGC0YwgUyDQv9C+INGD0LzQvtC70YfQsNC90LjRjiDQv9GD0YHRgtGL0LwgKNC40LvQuCDQvtGB0YLQsNCy0LjRgtGMLCDQtdGB0LvQuCDQsdGD0LTQtdGCINC30LDQtNCw0L3QviDQsiBIVE1MKVxuICB9XG5cbiAgLy8g0J3QvtCy0YvQuSDQvNC10YLQvtC0OiDQv9C+0LvRg9GH0LjRgtGMINC80LDRgtGA0LjRhtGDINC4INGA0LDQt9C80LXRgFxuICBwYXJzZU1hdHJpeEZyb21UZXh0YXJlYSh0ZXh0YXJlYVZhbHVlKSB7XG4gICAgY29uc3QgbGluZXMgPSB0ZXh0YXJlYVZhbHVlLnRyaW0oKS5zcGxpdCgnXFxuJykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkgIT09ICcnKTtcbiAgICBjb25zdCBtYXRyaXggPSBsaW5lcy5tYXAobGluZSA9PiBsaW5lLnRyaW0oKS5zcGxpdCgvXFxzKy8pLm1hcChOdW1iZXIpKTtcbiAgICAvLyDQn9GA0L7QstC10YDQutCwINC90LAg0L/RgNGP0LzQvtGD0LPQvtC70YzQvdC+0YHRgtGMICjQvtCx0YDQtdC30LDRgtGMINC70LjRiNC90LjQtSDRjdC70LXQvNC10L3RgtGLLCDQtdGB0LvQuCDRgdGC0YDQvtC60Lgg0YDQsNC30L3QvtC5INC00LvQuNC90YspXG4gICAgY29uc3QgbWluTGVuID0gTWF0aC5taW4oLi4ubWF0cml4Lm1hcChyb3cgPT4gcm93Lmxlbmd0aCkpO1xuICAgIGNvbnN0IHNxdWFyZU1hdHJpeCA9IG1hdHJpeC5tYXAocm93ID0+IHJvdy5zbGljZSgwLCBtaW5MZW4pKTtcbiAgICByZXR1cm4geyBtYXRyaXg6IHNxdWFyZU1hdHJpeCwgc2l6ZTogc3F1YXJlTWF0cml4Lmxlbmd0aCB9O1xuICB9XG5cbiAgZ2V0TWF0cml4QygpIHtcbiAgICBpZiAoIXRoaXMubWF0cml4Q1RleHRhcmVhKSByZXR1cm4geyBtYXRyaXg6IFtdLCBzaXplOiAwIH07XG4gICAgcmV0dXJuIHRoaXMucGFyc2VNYXRyaXhGcm9tVGV4dGFyZWEodGhpcy5tYXRyaXhDVGV4dGFyZWEudmFsdWUpO1xuICB9XG4gIGdldE1hdHJpeFQoKSB7XG4gICAgaWYgKCF0aGlzLm1hdHJpeFRUZXh0YXJlYSkgcmV0dXJuIHsgbWF0cml4OiBbXSwgc2l6ZTogMCB9O1xuICAgIHJldHVybiB0aGlzLnBhcnNlTWF0cml4RnJvbVRleHRhcmVhKHRoaXMubWF0cml4VFRleHRhcmVhLnZhbHVlKTtcbiAgfVxuICBnZXRQYXJhbXMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIFM6ICtkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2FsYXJ5LWZ1bmQnKS52YWx1ZSxcbiAgICAgIFRfdHlwZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3QtdHlwZScpLnZhbHVlLFxuICAgICAgVF9saW1pdDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3QtbGltaXQnKS52YWx1ZSA9PT0gJycgPyAnJyA6ICtkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndC1saW1pdCcpLnZhbHVlXG4gICAgfTtcbiAgfVxuICByZW5kZXJBbnN3ZXIoYW5zd2VyKSB7XG4gICAgY29uc3QgYW5zd2VyRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW5zd2VyJyk7XG4gICAgaWYgKHR5cGVvZiBhbnN3ZXIgPT09ICdzdHJpbmcnKSB7XG4gICAgICBhbnN3ZXJFbC50ZXh0Q29udGVudCA9IGFuc3dlcjtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IGh0bWwgPSAnPHRhYmxlPjx0aGVhZD48dHI+PHRoPjwvdGg+PHRoPjxiPtCg0LXRiNC10L3QuNC1PC9iPjwvdGg+PC90cj48L3RoZWFkPjx0Ym9keT4nO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYW5zd2VyLnBlcm0ubGVuZ3RoOyBpKyspIHtcbiAgICAgIGh0bWwgKz0gYDx0cj48dGg+eCR7aSArIDF9PC90aD48dGQ+JHthbnN3ZXIucGVybVtpXSArIDF9IChDOiAke2Fuc3dlci50YWJsZVtpXS5jfSwgVDogJHthbnN3ZXIudGFibGVbaV0udH0pPC90ZD48L3RyPmA7XG4gICAgfVxuICAgIGh0bWwgKz0gYDx0cj48dGg+UzwvdGg+PHRkPiR7YW5zd2VyLnN1bUN9PC90ZD48L3RyPmA7XG4gICAgaHRtbCArPSBgPHRyPjx0aD5UPC90aD48dGQ+JHthbnN3ZXIuVF92YWx1ZX08L3RkPjwvdHI+YDtcbiAgICBodG1sICs9ICc8L3Rib2R5PjwvdGFibGU+JztcbiAgICBhbnN3ZXJFbC5pbm5lckhUTUwgPSBodG1sO1xuICB9XG4gIHJlbmRlclNvbHV0aW9uVGFibGUoc29sdXRpb25zKSB7XG4gICAgY29uc3QgdGFibGVEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc29sdXRpb24tdGFibGUnKTtcbiAgICBpZiAoIXNvbHV0aW9ucyB8fCBzb2x1dGlvbnMubGVuZ3RoID09PSAwKSB7IHRhYmxlRGl2LmlubmVySFRNTCA9ICcnOyByZXR1cm47IH1cbiAgICBjb25zdCBuID0gc29sdXRpb25zWzBdLnBlcm0ubGVuZ3RoO1xuICAgIGxldCBodG1sID0gJzx0YWJsZT48dGhlYWQ+PHRyPjx0aD48L3RoPic7XG4gICAgc29sdXRpb25zLmZvckVhY2goKHNvbCwgaWR4KSA9PiB7XG4gICAgICBodG1sICs9IGA8dGgke3NvbC52YWxpZCA/ICcnIDogJyBzdHlsZT1cXFwib3BhY2l0eTowLjVcXFwiJ30+0KDQtdGI0LXQvdC40LUg4oSWICR7aWR4ICsgMX08L3RoPmA7XG4gICAgfSk7XG4gICAgaHRtbCArPSAnPC90cj48L3RoZWFkPjx0Ym9keT4nO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICBodG1sICs9IGA8dHI+PHRoPngke2kgKyAxfTwvdGg+YDtcbiAgICAgIHNvbHV0aW9ucy5mb3JFYWNoKChzb2wpID0+IHtcbiAgICAgICAgY29uc3Qgam9iSWR4ID0gc29sLnBlcm1baV07XG4gICAgICAgIGNvbnN0IGMgPSBzb2wudGFibGVbaV0uYztcbiAgICAgICAgY29uc3QgdCA9IHNvbC50YWJsZVtpXS50O1xuICAgICAgICBodG1sICs9IGA8dGQke3NvbC52YWxpZCA/ICcnIDogJyBzdHlsZT1cXFwib3BhY2l0eTowLjVcXFwiJ30+JHtqb2JJZHggKyAxfSAoQzogJHtjfSwgVDogJHt0fSk8L3RkPmA7XG4gICAgICB9KTtcbiAgICAgIGh0bWwgKz0gJzwvdHI+JztcbiAgICB9XG4gICAgaHRtbCArPSAnPHRyPjx0aD5TPC90aD4nO1xuICAgIHNvbHV0aW9ucy5mb3JFYWNoKChzb2wpID0+IHtcbiAgICAgIGh0bWwgKz0gYDx0ZCR7c29sLnZhbGlkID8gJycgOiAnIHN0eWxlPVxcXCJvcGFjaXR5OjAuNVxcXCInfT4ke3NvbC5zdW1DfTwvdGQ+YDtcbiAgICB9KTtcbiAgICBodG1sICs9ICc8L3RyPic7XG4gICAgaHRtbCArPSAnPHRyPjx0aD5UPC90aD4nO1xuICAgIHNvbHV0aW9ucy5mb3JFYWNoKChzb2wpID0+IHtcbiAgICAgIGh0bWwgKz0gYDx0ZCR7c29sLnZhbGlkID8gJycgOiAnIHN0eWxlPVxcXCJvcGFjaXR5OjAuNVxcXCInfT4ke3NvbC5UX3ZhbHVlfTwvdGQ+YDtcbiAgICB9KTtcbiAgICBodG1sICs9ICc8L3RyPic7XG4gICAgaHRtbCArPSAnPC90Ym9keT48L3RhYmxlPic7XG4gICAgdGFibGVEaXYuaW5uZXJIVE1MID0gaHRtbDtcbiAgfVxufVxuXG4vLyBDb250cm9sbGVyXG5jbGFzcyBBc3NpZ25tZW50Q29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMubW9kZWwgPSBudWxsO1xuICAgIHRoaXMudmlldyA9IG5ldyBBc3NpZ25tZW50VmlldygpO1xuICAgIHRoaXMuaW5pdEV2ZW50cygpO1xuICB9XG4gIGluaXRFdmVudHMoKSB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvbHZlLWJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5zb2x2ZSgpKTtcbiAgfVxuICBzb2x2ZSgpIHtcbiAgICBjb25zdCB7IG1hdHJpeDogQywgc2l6ZTogc2l6ZUMgfSA9IHRoaXMudmlldy5nZXRNYXRyaXhDKCk7XG4gICAgY29uc3QgeyBtYXRyaXg6IFQsIHNpemU6IHNpemVUIH0gPSB0aGlzLnZpZXcuZ2V0TWF0cml4VCgpO1xuICAgIHdpbmRvdy5hc3NpZ25tZW50TW9kZWxJbnB1dEMgPSBDO1xuICAgIHdpbmRvdy5hc3NpZ25tZW50TW9kZWxJbnB1dFQgPSBUO1xuICAgIGNvbnN0IG4gPSBNYXRoLm1pbihzaXplQywgc2l6ZVQpO1xuICAgIGlmICghbiB8fCBDLmxlbmd0aCAhPT0gbiB8fCBULmxlbmd0aCAhPT0gbikge1xuICAgICAgdGhpcy52aWV3LnJlbmRlckFuc3dlcign0J7RiNC40LHQutCwOiDQvdC10LrQvtGA0YDQtdC60YLQvdGL0Lkg0LLQstC+0LQg0LzQsNGC0YDQuNGGJyk7XG4gICAgICB0aGlzLnZpZXcucmVuZGVyU29sdXRpb25UYWJsZShbXSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMubW9kZWwgPSBuZXcgQXNzaWdubWVudE1vZGVsKG4pO1xuICAgIHRoaXMubW9kZWwuc2V0TWF0cml4QyhDKTtcbiAgICB0aGlzLm1vZGVsLnNldE1hdHJpeFQoVCk7XG4gICAgY29uc3QgcGFyYW1zID0gdGhpcy52aWV3LmdldFBhcmFtcygpO1xuICAgIHRoaXMubW9kZWwuc2V0UyhwYXJhbXMuUyk7XG4gICAgdGhpcy5tb2RlbC5zZXRUVHlwZShwYXJhbXMuVF90eXBlKTtcbiAgICB0aGlzLm1vZGVsLnNldFRMaW1pdChwYXJhbXMuVF9saW1pdCk7XG4gICAgY29uc3QgeyBhbnN3ZXIsIHNvbHV0aW9ucyB9ID0gdGhpcy5tb2RlbC5zb2x2ZSgpO1xuICAgIHRoaXMudmlldy5yZW5kZXJBbnN3ZXIoYW5zd2VyLmFuc3dlciB8fCBhbnN3ZXIpO1xuICAgIHRoaXMudmlldy5yZW5kZXJTb2x1dGlvblRhYmxlKHNvbHV0aW9ucyk7XG4gIH1cbn1cblxuLy8g0JjQvdC40YbQuNCw0LvQuNC30LDRhtC40Y9cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICBuZXcgQXNzaWdubWVudENvbnRyb2xsZXIoKTtcbn0pOyAiXX0=
